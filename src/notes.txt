tidy up the code
return the optimal path 
